"use strict";Object.defineProperty(exports, "__esModule", {value: true});var _chunk7I3R3VMIjs = require('./chunk-7I3R3VMI.js');var d=_chunk7I3R3VMIjs.c.call(void 0, (P,T)=>{function a(r,t){typeof t=="boolean"&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(r)),this._timeouts=r,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||Infinity,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}T.exports=a;a.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts};a.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timeouts=[],this._cachedTimeouts=null};a.prototype.retry=function(r){if(this._timeout&&clearTimeout(this._timeout),!r)return!1;var t=new Date().getTime();if(r&&t-this._operationStart>=this._maxRetryTime)return this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(r);var i=this._timeouts.shift();if(i===void 0)if(this._cachedTimeouts)this._errors.splice(this._errors.length-1,this._errors.length),this._timeouts=this._cachedTimeouts.slice(0),i=this._timeouts.shift();else return!1;var e=this,o=setTimeout(function(){e._attempts++,e._operationTimeoutCb&&(e._timeout=setTimeout(function(){e._operationTimeoutCb(e._attempts)},e._operationTimeout),e._options.unref&&e._timeout.unref()),e._fn(e._attempts)},i);return this._options.unref&&o.unref(),!0};a.prototype.attempt=function(r,t){this._fn=r,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var i=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){i._operationTimeoutCb()},i._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};a.prototype.try=function(r){console.log("Using RetryOperation.try() is deprecated"),this.attempt(r)};a.prototype.start=function(r){console.log("Using RetryOperation.start() is deprecated"),this.attempt(r)};a.prototype.start=a.prototype.try;a.prototype.errors=function(){return this._errors};a.prototype.attempts=function(){return this._attempts};a.prototype.mainError=function(){if(this._errors.length===0)return null;for(var r={},t=null,i=0,e=0;e<this._errors.length;e++){var o=this._errors[e],s=o.message,n=(r[s]||0)+1;r[s]=n,n>=i&&(t=o,i=n)}return t}});var w=_chunk7I3R3VMIjs.c.call(void 0, u=>{var q=d();u.operation=function(r){var t=u.timeouts(r);return new q(t,{forever:r&&r.forever,unref:r&&r.unref,maxRetryTime:r&&r.maxRetryTime})};u.timeouts=function(r){if(r instanceof Array)return[].concat(r);var t={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:Infinity,randomize:!1};for(var i in r)t[i]=r[i];if(t.minTimeout>t.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var e=[],o=0;o<t.retries;o++)e.push(this.createTimeout(o,t));return r&&r.forever&&!e.length&&e.push(this.createTimeout(o,t)),e.sort(function(s,n){return s-n}),e};u.createTimeout=function(r,t){var i=t.randomize?Math.random()+1:1,e=Math.round(i*t.minTimeout*Math.pow(t.factor,r));return e=Math.min(e,t.maxTimeout),e};u.wrap=function(r,t,i){if(t instanceof Array&&(i=t,t=null),!i){i=[];for(var e in r)typeof r[e]=="function"&&i.push(e)}for(var o=0;o<i.length;o++){var s=i[o],n=r[s];r[s]=function(R){var c=u.operation(t),h=Array.prototype.slice.call(arguments,1),S=h.pop();h.push(function(_){c.retry(_)||(_&&(arguments[0]=c.mainError()),S.apply(this,arguments))}),c.attempt(function(){R.apply(r,h)})}.bind(r,n),r[s].options=t}}});var g=_chunk7I3R3VMIjs.c.call(void 0, (B,v)=>{v.exports=w()});var x=_chunk7I3R3VMIjs.c.call(void 0, (W,f)=>{"use strict";var C=g(),N=["Failed to fetch","NetworkError when attempting to fetch resource","The Internet connection appears to be offline","Network request failed"],l=class extends Error{constructor(t){super();t instanceof Error?(this.originalError=t,{message:t}=t):(this.originalError=new Error(t),this.originalError.stack=this.stack),this.name="AbortError",this.message=t}},k=(r,t,i)=>{let e=i.retries-(t-1);return r.attemptNumber=t,r.retriesLeft=e,r},I=r=>N.includes(r),E=(r,t)=>new Promise((i,e)=>{t=_chunk7I3R3VMIjs.a.call(void 0, {onFailedAttempt:()=>{},retries:10},t);let o=C.operation(t);o.attempt(async s=>{try{i(await r(s))}catch(n){if(!(n instanceof Error)){e(new TypeError(`Non-error was thrown: "${n}". You should only throw errors.`));return}if(n instanceof l)o.stop(),e(n.originalError);else if(n instanceof TypeError&&!I(n.message))o.stop(),e(n);else{k(n,s,t);try{await t.onFailedAttempt(n)}catch(p){e(p);return}o.retry(n)||e(o.mainError())}}})});f.exports=E;f.exports.default=E;f.exports.AbortError=l});var b=_chunk7I3R3VMIjs.d.call(void 0, x()),L= exports.a =(r,t)=>new Promise(i=>{let e=new Set,o=setTimeout(i,t);r.requestWillBeSent(({requestId:s})=>{e.add(s),clearTimeout(o)}),r.loadingFinished(({requestId:s})=>{e.delete(s),e.size===0&&(o=setTimeout(i,t))})}),F=r=>new Promise(t=>{setTimeout(t,r)}),M= exports.b =async(r,t,i)=>await(0,b.default)(async()=>{let{nodeId:e}=await r.querySelector({nodeId:t,selector:i});if(e===0)throw new Error("Not found");return e},{retries:3,onFailedAttempt:async()=>await F(100)}),O= exports.c =async(r,t,i)=>{let e=await M(r,t,i);await r.setAttributeValue({nodeId:e,name:"style",value:"visibility: hidden"})},U= exports.d =async(r,t,i)=>{try{let{model:e}=await t.getBoxModel({nodeId:i}),o=await r.captureScreenshot({clip:{x:0,y:0,width:e.width,height:e.height,scale:1}});return Buffer.from(o.data,"base64")}catch(e){throw console.log(e),new Error("Failed to take a snapshot")}};exports.a = L; exports.b = M; exports.c = O; exports.d = U;
